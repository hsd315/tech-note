# app api 接口设计

## 客户端

### 必传参数

参数名 | 参数类型 | 说明
------ | -------- | ---
version | int | api版本号
platform | string | 取值为: pc, h5, iphone, ipad, android, other 之一
token | string(32) | 用户需要持token才能访问受保护的数据,没有持有时请传空`""`
`app_id` | string | app 维护的唯一 id
rtime | bigint | 用户发起请求的时间戳

### 发送请求加密算法

1. 将所有待传送参数放入字典中
2. 将字典生成为一个标准`JSON`字符串
3. 使用`RSA`公钥加密`JSON`字符串,并进行`base64`编码
4. 将生成的密文串赋值给`data`
5. 通过`HTTP``POST`方式将报文发送到服务端

### 接收响应解密算法

1. 解析服务端的`JSON`数据,如果`code`不等于`0`,则异常处理
2. 将`data`字段的内容`base64`解码后使用`RSA`公钥解密,得到服务端原始报文
3. 解析原始报文(`JSON`字符串)

## 服务端

### 接收请求解密算法

1. 将`data`字段的内容`base64`解码后使用`RSA`私钥解密,得到客户端原始报文
2. 解析原始报文(`JSON`字符串)

### 响应请求加密算法

1. 将业务结果集放入一个字典
2. 将字典生成为一个标准`JSON`字符串
3. 使用`RSA`服务端私钥加密`JSON`字符串,并进行`base64`编码
4. 将生成的密文串赋值给响应体的`data`
5. 将响应体组织成`JSON`数据,发送给客户端

### 响应请求数据结构说明

- 所有接口返回JSON,包含4个基本元素: `code`, `message`, `data`, `server_time`
- 仅当`code`等于`0`,说明接口响应正确,其他值均为出错,请接口调用方根据业务自行处理后续
- `message`为出错时错误提示,可直接用于向用户展示出错信息
- `data`服务端使用私钥加密后的密文,异常是为空字符串
- `server_time`服务端响应请求的unix时间戳

